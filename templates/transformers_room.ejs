<% layout('/layout/page')%>
<% block('title', 'transformers room')%>

<div class="container">
    <p>Transformers exist: </p>
    <ul id="transformers">
        <li><%=name%></li>
    </ul>
</div>
<script>


    subscribe();

    function subscribe() {
        let xhr = new XMLHttpRequest();

        xhr.open("GET", "subscribe", true);

        xhr.onload = function () {
            let li = document.createElement("li");
            li.textContent = this.responseText;
            transformers.appendChild(li);

            subscribe();
        };

        xhr.onerror = xhr.onabort = function () {
            setTimeout(subscribe, 500);
        };

        xhr.send('');
    }
</script>